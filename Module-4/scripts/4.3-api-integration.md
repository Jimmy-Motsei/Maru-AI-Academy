# 4.3 â€” API Integration (Instructor Script)

**Length:** ~15 min

## Create API service (3 minutes)

"First, let's create a service to handle all API calls:

```typescript
// src/services/api.ts
import axios from "axios";

const API_BASE_URL = "http://localhost:3000"; // Your Module 2-3 API

export const api = axios.create({
  baseURL: API_BASE_URL,
  headers: {
    "Content-Type": "application/json",
  },
});

export interface Lead {
  id: string;
  name: string;
  company: string;
  message: string;
  budget: string;
  urgency: string;
  score: number;
  segment: "Hot" | "Warm" | "Nurture";
  createdAt: string;
}

export const leadService = {
  async getLeads(): Promise<Lead[]> {
    const response = await api.get("/leads");
    return response.data;
  },

  async scoreLead(
    leadData: Omit<Lead, "id" | "score" | "segment" | "createdAt">
  ): Promise<Lead> {
    const response = await api.post("/score", leadData);
    return response.data;
  },
};
```

_[Create the file and explain each part]_

## Create custom hooks (4 minutes)

"Let's create a custom hook to manage lead data:

```typescript
// src/hooks/useLeads.ts
import { useState, useEffect } from "react";
import { leadService, Lead } from "../services/api";

export const useLeads = () => {
  const [leads, setLeads] = useState<Lead[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  const fetchLeads = async () => {
    try {
      setLoading(true);
      setError(null);
      const data = await leadService.getLeads();
      setLeads(data);
    } catch (err) {
      setError(err instanceof Error ? err.message : "Failed to fetch leads");
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => {
    fetchLeads();
  }, []);

  return { leads, loading, error, refetch: fetchLeads };
};
```

_[Explain the hook pattern and error handling]_

## Create the main component (4 minutes)

"Now let's create our main dashboard component:

```typescript
// src/pages/Dashboard.tsx
import React from "react";
import { useLeads } from "../hooks/useLeads";
import { LeadTable } from "../components/LeadTable";
import { LoadingSpinner } from "../components/LoadingSpinner";
import { ErrorMessage } from "../components/ErrorMessage";

export const Dashboard: React.FC = () => {
  const { leads, loading, error, refetch } = useLeads();

  if (loading) return <LoadingSpinner />;
  if (error) return <ErrorMessage message={error} onRetry={refetch} />;

  return (
    <div className="dashboard">
      <h1>Lead Qualification Dashboard</h1>
      <LeadTable leads={leads} />
    </div>
  );
};
```

_[Show the component structure and explain props]_

## Handle loading and error states (4 minutes)

"Let's create the supporting components:

```typescript
// src/components/LoadingSpinner.tsx
export const LoadingSpinner: React.FC = () => (
  <div className="loading-spinner">
    <div className="spinner"></div>
    <p>Loading leads...</p>
  </div>
);

// src/components/ErrorMessage.tsx
interface ErrorMessageProps {
  message: string;
  onRetry: () => void;
}

export const ErrorMessage: React.FC<ErrorMessageProps> = ({
  message,
  onRetry,
}) => (
  <div className="error-message">
    <h2>Something went wrong</h2>
    <p>{message}</p>
    <button onClick={onRetry}>Try Again</button>
  </div>
);
```

_[Explain the importance of good UX for loading and error states]_

## Test the connection (2 minutes)

"Let's make sure our API is running and test the connection:

```bash
# In one terminal - start your Module 2-3 API
cd ../Module-2/code
npm start

# In another terminal - start the React app
cd ../Module-4/code
npm run dev
```

_[Test the connection and show the data flowing]_

Perfect! Now we have a working connection between our frontend and API."
